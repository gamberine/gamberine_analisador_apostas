<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="https://gamberine.com.br/wp-content/uploads/gamberine_favicon.png">
<title>Gamberine - Analisador de Apostas</title>
<link rel="stylesheet" href="https://gamberine.com.br/arquivos_publicos/gamb_variables_geral.css">
<meta name="description" content="Análise prévia, tabela de apostas e marcador automático do resultado da Quina.">
<style>
  :root {
    --bg:#0b1020; --card:#111832; --accent:#36b37e; --muted:#c7cedf; --text:#f1f5ff; --hit:#ffe08a; --drawn:#3b82f6;
    --danger:#ef4444; --ok:#22c55e;
  }
  * { box-sizing:border-box; }
  body { margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial; background:var(--bg); color:var(--text);}
  header {
    padding: 20px;
    background: linear-gradient(90deg, #18233f, #0f172a);
    border-bottom: 1px solid #223;
    text-align: center;
  }
  h1 { margin:0 0 6px; font-size:20px; }
  .sub { opacity:.8; font-size:13px; }
  main { max-width:1100px; margin:24px auto; padding:0 16px; }
  .card { background:var(--card); border:1px solid #223; border-radius:14px; padding:16px; margin-bottom:16px; }
  .grid { display:grid; gap:16px; grid-template-columns: 1fr; }
  @media (min-width:900px) { .grid { grid-template-columns: 1fr 1fr; } }
  .badge { display:inline-block; padding:2px 8px; border-radius:999px; background:#1f2937; color:#e5e7eb; font-size:12px; margin-right:6px; }
  .accent { color:var(--accent); }
  table { width:100%; border-collapse:collapse; }
  th, td { border:1px solid #2a355d; padding:8px; text-align:center; font-variant-numeric: tabular-nums; }
  th { background:#0f1a36; position:sticky; top:0; z-index:1; }
  tbody tr:nth-child(odd) { background:#0e1530; }
  .num { display:inline-flex; width:34px; height:34px; align-items:center; justify-content:center; border-radius:8px; background:#0b1228; border:1px solid #2a355d; margin:2px; }
  .num.drawn { background:var(--drawn); color:#fff; border-color:#1e3a8a; }
  .num.hit { background: var(--primaryColor); color: #111; border-color: var(--primaryColorHover); font-weight: 700; }
  .controls { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  input[type=text], input[type=date], textarea { padding:10px 12px; background:#0b1228; color:#e5e7eb; border:1px solid #2a355d; border-radius:10px; width:100%; }
  button { padding:10px 14px; border:1px solid #2a355d; background:#0b1228; color:#e5e7eb; border-radius:10px; cursor:pointer; }
  button:hover { border-color:#3b82f6; }
  .note { font-size:12px; opacity:.8; }
  .warn { color: #fca5a5; }
  .ok { color: #86efac; }
  footer { padding:20px; text-align:center; opacity:.7; }

  /* Accordion styles */
  details.accordion{background:var(--card);border:1px solid #223;border-radius:14px;margin-bottom:16px;padding:0 16px;}
  details.accordion summary{list-style:none;cursor:pointer;padding:16px 0;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;align-items:center;gap:8px;}
  details.accordion summary::-webkit-details-marker{display:none;}
  details.accordion summary h2{margin:0;font-size:18px;}
  details.accordion .accordion-content{padding:0 0 16px 0;}
  details.accordion summary::after{content:"▸";margin-left:auto;opacity:.7;}
  details.accordion[open] summary::after{content:"▾";}

  /* Responsivo pedido */
  @media (max-width: 1280px) {
    .card {
      background: var(--card);
      border: 1px solid #223;
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 16px;
      text-align: center;
    }
    .controls {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
    }
  }
</style>
</head>
<body>
<header>
  <h1>Gamberine - Analisador de Apostas</h1>
  <div class="sub">Data do sorteio: <strong>30/09/2025</strong></div>
</header>
<main>
  <section class="card">
    <h2>1. Insira os dados</h2>
    <div class="controls" style="flex-direction: column; align-items: stretch; gap: 1rem;">
      <textarea id="bets-input" rows="12" placeholder="Cole as apostas aqui, uma por linha. Ex: #01: 10-20-30-40-50"></textarea>
      <input type="date" id="result-date" title="Data do sorteio">
      <button onclick="processInputs()">Gerar Tabela e Link para Compartilhamento</button>
    </div>
    <div id="generated-link-container" style="margin-top: 1rem;"></div>
  </section>

  <section id="results-section" class="card" style="display:none;">
    <h2>2. Marcar Resultado do Sorteio</h2>
    <div class="controls">
      <label for="drawn">Insira os 5 números sorteados:</label>
      <input id="drawn" type="text" placeholder="Ex: 02,16,31,54,78">
      <button class="btn btnPrimary" onclick="applyDrawn()">Aplicar</button>
      <button onclick="clearDrawn()" class="btn btnSecondary">Limpar</button>
      <span id="summary" class="badge">Aguardando...</span>
    </div>
  </section>

  <section id="bets-section" class="card" style="display:none;">
    <h2>Tabela de apostas</h2>
    <table id="bets">
      <thead>
        <tr><th>#</th><th>Dezenas</th><th>Acertos</th></tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </section>
</main>

<footer>© 2025 — Gamberine</footer>

<script>
let betsData = {};

function pad(n) { return String(n).padStart(2,'0'); }

function parseBets(text) {
  const lines = text.split('\n');
  const parsedBets = {};
  for (const line of lines) {
    if (line.trim() === '') continue;
    const match = line.match(/#?(\d+)\s*:\s*([\d\s,-]+)/);
    if (match) {
        const id = parseInt(match[1]);
        const numbers = match[2].match(/\d+/g);
        if (numbers && numbers.length === 5) {
            parsedBets[id] = numbers.map(n => parseInt(n));
        }
    }
  }
  return parsedBets;
}

function processInputs() {
  const betsText = document.getElementById('bets-input').value;
  betsData = parseBets(betsText);

  const dateValue = document.getElementById('result-date').value;
  if (dateValue) {
    const date = new Date(dateValue + 'T00:00:00');
    document.querySelector('header .sub strong').textContent = date.toLocaleDateString('pt-BR', { timeZone: 'UTC' });
    document.title = 'Gamberine - Quina : Análise/Apostas ('+date.toLocaleDateString('pt-BR', { timeZone: 'UTC' })+')';
  }

  if (Object.keys(betsData).length > 0) {
    document.getElementById('results-section').style.display = 'block';
    document.getElementById('bets-section').style.display = 'block';
    renderRows(null);
    updateLink();
  } else {
    alert('Nenhuma aposta válida encontrada. Verifique o formato (ex: #01: 10-20-30-40-50).');
  }
}

function renderRows(drawnSet) {
  const tbody = document.querySelector('#bets tbody');
  tbody.innerHTML = '';

  const sortedKeys = Object.keys(betsData).map(k => parseInt(k)).sort((a,b) => a-b);

  for (const key of sortedKeys) {
    const arr = betsData[key];
    const tr = document.createElement('tr');
    const tdIdx = document.createElement('td');
    tdIdx.textContent = '#' + pad(key);
    const tdNums = document.createElement('td');
    const tdHits = document.createElement('td');

    let hits = 0;
    arr.forEach(n => {
      const span = document.createElement('span');
      span.className = 'num' + (drawnSet && drawnSet.has(n) ? ' hit drawn' : '');
      if (drawnSet && drawnSet.has(n)) hits++;
      span.textContent = pad(n);
      tdNums.appendChild(span);
    });
    tdHits.textContent = hits;
    tr.appendChild(tdIdx);
    tr.appendChild(tdNums);
    tr.appendChild(tdHits);
    tbody.appendChild(tr);
  }
}

function parseDrawn(input) {
  const digits = input.replace(/\D/g, '');
  const nums = new Set();
  for (let i = 0; i < digits.length && nums.size < 5; i += 2) {
    const n = parseInt(digits.substring(i, i + 2), 10);
    if (n >= 1 && n <= 80) {
      nums.add(n);
    }
  }
  return nums;
}

function applyDrawn() {
  const drawnInput = document.getElementById('drawn');
  const drawn = parseDrawn(drawnInput.value);
  if (drawn.size !== 5) {
    document.getElementById('summary').textContent = 'Informe exatamente 5 dezenas válidas.';
    document.getElementById('summary').className = 'badge warn';
    return;
  }
  
  drawnInput.value = Array.from(drawn).sort((a,b)=>a-b).map(pad).join('-');
  
  renderRows(drawn);
  updateLink();

  const rows = Array.from(document.querySelectorAll('#bets tbody tr'));
  let t2=0,t3=0,t4=0,t5=0;
  rows.forEach(r => {
    const c = parseInt(r.lastChild.textContent||'0',10);
    if (c===2) t2++; else if (c===3) t3++; else if (c===4) t4++; else if (c===5) t5++;
  });
  const sum = `Duques: ${t2} • Ternos: ${t3} • Quadras: ${t4} • Quinas: ${t5}`;
  document.getElementById('summary').textContent = sum;
  document.getElementById('summary').className = 'badge ok';
}

function clearDrawn() {
  document.getElementById('drawn').value='';
  document.getElementById('summary').textContent='Aguardando...';
  document.getElementById('summary').className='badge';
  renderRows(null);
  updateLink();
}

function updateLink() {
    const container = document.getElementById('generated-link-container');
    if (Object.keys(betsData).length === 0) {
        container.innerHTML = '';
        return;
    }
    const url = new URL(window.location.href);
    url.search = '';

    const betsString = Object.keys(betsData).sort((a,b)=>parseInt(a)-parseInt(b)).map(key => betsData[key].join('-')).join('_');
    url.searchParams.set('bets', betsString);

    const date = document.getElementById('result-date').value;
    if (date) {
        url.searchParams.set('date', date);
    }

    const drawnValue = document.getElementById('drawn').value;
    const drawn = parseDrawn(drawnValue);
    if (drawn.size === 5) {
        url.searchParams.set('d', Array.from(drawn).sort((a,b)=>a-b).join(','));
    }

    container.innerHTML = `<strong>Link Gerado:</strong><div class="controls" style="margin-top: 0.5rem;"><input type="text" readonly value="${url.toString()}" onclick="this.select()"><button onclick="copyGeneratedLink()">Copiar Link</button></div>`;
}

function copyGeneratedLink() {
    const linkInput = document.querySelector('#generated-link-container input');
    if (linkInput) {
        navigator.clipboard.writeText(linkInput.value).then(() => {
            const btn = document.querySelector('#generated-link-container button');
            if(btn) {
              btn.textContent = 'Copiado!';
              setTimeout(() => { btn.textContent = 'Copiar Link'; }, 2000);
            }
        });
    }
}

(function init() {
  const url = new URL(window.location.href);
  const betsParam = url.searchParams.get('bets');
  const dateParam = url.searchParams.get('date');
  const dParam = url.searchParams.get('d');

  if (betsParam) {
    const parsedBets = {};
    const betsArray = betsParam.split('_');
    let betsInputText = '';
    let currentId = 1;
    betsArray.forEach((betString) => {
        const numbers = betString.split('-').map(n => parseInt(n));
        if(numbers.length === 5){
          parsedBets[currentId] = numbers;
          betsInputText += `#${String(currentId).padStart(2, '0')}: ${numbers.join('-')}\n`;
          currentId++;
        }
    });
    betsData = parsedBets;
    document.getElementById('bets-input').value = betsInputText.trim();

    if (dateParam) {
        document.getElementById('result-date').value = dateParam;
        const date = new Date(dateParam + 'T00:00:00');
        const dateString = date.toLocaleDateString('pt-BR', { timeZone: 'UTC' });
        document.querySelector('header .sub strong').textContent = dateString;
        document.title = 'Gamberine - Quina : Análise/Apostas ('+dateString+')';
    }

    document.getElementById('results-section').style.display = 'block';
    document.getElementById('bets-section').style.display = 'block';
    document.querySelector('main > section:first-child').style.display = 'none';

    let drawnSet = null;
    if (dParam) {
        document.getElementById('drawn').value = dParam;
        drawnSet = parseDrawn(dParam);
    }
    
    renderRows(drawnSet);
    
    if(drawnSet && drawnSet.size === 5) {
        applyDrawn();
    }
    
    // We need to show the main section again to show the link
    document.querySelector('main > section:first-child').style.display = 'block';
    updateLink();
    // and hide the inputs within that section
    document.querySelector('#bets-input').style.display = 'none';
    document.querySelector('#result-date').style.display = 'none';
    document.querySelector('main > section:first-child button').style.display = 'none';
    document.querySelector('main > section:first-child h2').textContent = 'Link de Compartilhamento';
  }
})();
</script>
</body>
</html>